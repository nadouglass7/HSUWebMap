function CMPanelTabs(TheCanvasMap){CMBase.call(this);if(TheCanvasMap==undefined)alert("Sorry, the CMPanelTabs requires a CanvasMap object on construction");this.SetParent(TheCanvasMap);this.Tabs=[];this.TabContents=[];}CMPanelTabs.prototype=Object.create(CMBase.prototype);CMPanelTabs.prototype.contructor=CMPanelTabs;CMPanelTabs.prototype.GetTabIndexFromName=function(TabName){var Result=-1;for(var i=0;i<this.Tabs.length;i++){if(this.Tabs[i].Name==TabName){Result=i;}}return(Result);}
CMPanelTabs.prototype.SetElement=function(TheElement){this.TheElement=TheElement;this.TabContainer=document.createElement("DIV");this.TabContainer.className="CM_Tabs";this.TheElement.appendChild(this.TabContainer);}
CMPanelTabs.prototype.AddTab=function(ContentID,Name,ToolTip,TabContent){if(this.TheElement!=null){var TabElement=document.createElement("button");TabElement.id=ContentID+"_tab";TabElement.className="tablinks";if(ToolTip!=undefined)TabElement.title=ToolTip;TabElement.innerHTML=Name;TabElement.Selected=false;TabElement.TabPanel=this;TabElement.Name=Name;TabElement.onclick=function(){this.TabPanel.SelectTab(this.Name);CMMainContainer.HidePopupWindow();}
this.Tabs.push(TabElement);this.TabContainer.appendChild(TabElement);if(CMUtilities.IsDefined(TabContent)==false){TabContent=document.createElement("DIV");TabContent.id=ContentID;TabContent.className="CM_TabContent";}TabContent.style.display="none";this.TabContents.push(TabContent);this.TheElement.appendChild(TabContent);}return(TabContent);}
CMPanelTabs.prototype.SelectTab=function(TabName){for(var i=0;i<this.Tabs.length;i++){if(this.Tabs[i].Name==TabName){this.TabContents[i].style.display="block";this.Tabs[i].className=this.Tabs[i].className+=" active";}else{this.TabContents[i].style.display="none";this.Tabs[i].className=this.Tabs[i].className.replace(" active","");}}}
CMPanelTabs.prototype.GetTabContentElement=function(TabName){var Result=null;var Index=this.GetTabIndexFromName(TabName);if(Index!=-1)Result=this.TabContents[Index];return(Result);}
CMPanelTabs.prototype.RemoveTab=function(TabName){var Index=this.GetTabIndexFromName(TabName);if(Index!=-1){var TabElement=this.Tabs[Index];TabElement.parentNode.removeChild(TabElement);this.Tabs.splice(Index,1);this.TabContents.splice(Index,1);}}