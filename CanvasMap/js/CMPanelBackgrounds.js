CMPanelBackgrounds.LAYER_LIST_ITEM_HEIGHT=24;CMPanelBackgrounds.LAYER_POPUP_MENU_ITEM_HEIGHT=24;function CMPanelBackgrounds(TheCanvasMap){CMBase.call(this);if(TheCanvasMap==undefined)alert("Sorry, the CMPanelBackgrounds requires a CanvasMap object on construction");this.SetParent(TheCanvasMap);var TheScene=TheCanvasMap.GetScene();TheScene.AddListener(CMScene.MESSAGE_BACKGROUNDS_CHANGED,this,function(TheScene,TheListener,AdditionalInfo){TheListener.Setup(TheScene);});this.TheElement=null;this.LayerListItemHeight=CMPanelBackgrounds.LAYER_LIST_ITEM_HEIGHT;this.LayerPopupMenuItemHeight=CMPanelBackgrounds.LAYER_POPUP_MENU_ITEM_HEIGHT;}CMPanelBackgrounds.prototype=Object.create(CMBase.prototype);CMPanelBackgrounds.prototype.contructor=CMPanelBackgrounds;CMPanelBackgrounds.prototype.SetElement=function(TheElement){this.TheElement=TheElement;}
CMPanelBackgrounds.prototype.Setup=function(TheScene){var TheElement=this.TheElement;var Left=TheElement.style.left;var Top=TheElement.style.top;Left=0;Top=6;for(var i=0;(i<TheScene.Backgrounds.length);i++){var TheBackground=TheScene.Backgrounds[i];if(i!=TheScene.SelectedBackgroundIndex)TheBackground.SetVisible(false);var LayerInListTop=Top+(i*this.LayerListItemHeight);var LayerInList=document.createElement('div');LayerInList.className="CM_BackgroundListItemClass";var LayerListWidth=jQuery(TheElement).outerWidth(false);CMUtilities.AbsolutePosition(LayerInList,Left+2,LayerInListTop,LayerListWidth,this.LayerListItemHeight);TheElement.appendChild(LayerInList);var TheCheckBox=document.createElement('input');TheCheckBox.className="CM_BackgroundListRadioButtonClass";TheCheckBox.name="Background";TheCheckBox.value=TheScene.Backgrounds[i].Name;TheCheckBox.type="radio";TheCheckBox.TheScene=TheScene;TheCheckBox.TheBackground=TheScene.Backgrounds[i];TheCheckBox.ThisIndex=i;TheCheckBox.addEventListener('click',function(){if(this.checked){this.TheScene.SetSelectedBackgroundIndex(this.ThisIndex);}});TheCheckBox.checked=false;if(TheScene.SelectedBackgroundIndex==i)TheCheckBox.checked=true;CMUtilities.AbsolutePosition(TheCheckBox,Left+2,-6,14,this.LayerListItemHeight);LayerInList.appendChild(TheCheckBox);var TheLayerName=document.createElement('div');TheLayerName.className="CM_BackgroundListNameClass";TheLayerName.innerHTML=TheScene.Backgrounds[i].Name;CMUtilities.AbsolutePosition(TheLayerName,Left+30,0,150,this.LayerListItemHeight);LayerInList.appendChild(TheLayerName);}};